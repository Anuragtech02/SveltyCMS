---
path: 'docs/Dev_Guide/07_Widgets/Widget_Marketplace_System.mdx'
title: 'Widget Marketplace System'
description: 'Complete guide to the widget marketplace - installation, development, and publishing'
order: 75
icon: 'mdi:store'
author: 'admin'
created: '2025-08-05'
updated: '2025-10-02'
tags:
  - 'developer'
  - 'widgets'
  - 'marketplace'
  - 'extensions'
---

# Widget Marketplace System

The SveltyCMS Widget Marketplace allows users to discover, install, and manage custom widgets from a central repository. This system supports multi-tenant installations with proper isolation and security.

## 🏪 Marketplace Overview

### System Architecture

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Marketplace   │    │   CMS Instance  │    │   Widget Store  │
│                 │    │                 │    │                 │
│ ├─ Browse       │◄──►│ ├─ Install      │◄──►│ ├─ Core Widgets │
│ ├─ Search       │    │ ├─ Activate     │    │ ├─ Custom       │
│ ├─ Categories   │    │ ├─ Configure    │    │ ├─ Installed    │
│ └─ Purchase     │    │ └─ Uninstall    │    │ └─ Active       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### Widget Lifecycle

1. **🔍 Discovery** - Browse marketplace, search widgets
2. **💾 Installation** - Download and install to tenant
3. **⚡ Activation** - Enable widget for use in collections
4. **⚙️ Configuration** - Set up widget parameters
5. **📊 Usage** - Use in collections and content
6. **🔄 Updates** - Automatic or manual widget updates
7. **🗑️ Uninstallation** - Remove widget from tenant

## 🎯 Widget Categories

### Core Widgets (Always Available)

- **Input Controls**: Text, Number, Email, Password
- **Selection**: Dropdown, Radio, Checkbox
- **Media**: File Upload, Image, Video
- **Content**: Rich Text, Markdown
- **Date/Time**: Date Picker, DateTime, Range

Note: The core `date` widget supports `timePicker` to provide DateTime behaviour and the `dateRange` core widget covers ranges — no separate `DateTime` core widget is required.

- **Relationships**: Entity Selector, References

### Marketplace Categories

- **📱 Forms & Input** - Advanced form controls
- **🎨 Media & Gallery** - Image/video management
- **💰 E-commerce** - Product, Cart, Payment widgets
- **📊 Analytics** - Charts, Graphs, Metrics
- **🌐 Social** - Social media integration
- **🔧 Productivity** - Calendar, Tasks, Notes
- **🎯 Marketing** - SEO, Analytics, Campaigns
- **🏢 Business** - CRM, Invoicing, Reports

## 🛠️ Widget Management Interface

### Location

```
📁 src/routes/(app)/config/widgetManagement/
├── +page.svelte                 # Main widget management page
├── +page.server.ts             # Server-side logic & permissions
└── WidgetDashboard.svelte      # Widget management component
```

### Features

- **📊 Overview Dashboard** - Widget statistics and health
- **🔧 Widget Control** - Activate/deactivate widgets
- **🏪 Marketplace Browse** - Discover new widgets
- **📦 Installation Manager** - Install/uninstall widgets
- **⚠️ Dependency Check** - Validate widget dependencies
- **🔍 Collection Analysis** - Required widgets by collections

Migration tips for marketplace authors:

- Prefer adding GUI overrides rather than creating duplicate core functionality. For example, rather than shipping separate email/phone widgets, provide an `Input` wrapper that configures `inputType` and any additional validation.
- Use the `validationSchema: (field) => ...` function form when your widget's validation depends on field options (for example – a currency widget that validates based on a `precision` option).
- **🚨 Validation Warnings** - Missing widget alerts

### Interface Sections

#### Summary Cards

```svelte
<!-- Core Widgets - Always enabled -->
<div class="rounded-lg bg-blue-50 p-4">
	<h3>Core Widgets</h3>
	<p class="text-2xl font-bold">{coreWidgetsList.length}</p>
	<p class="text-sm">Always enabled</p>
</div>

<!-- Active Custom Widgets -->
<div class="rounded-lg bg-green-50 p-4">
	<h3>Active Custom</h3>
	<p class="text-2xl font-bold">{activeCustomCount}</p>
	<p class="text-sm">Currently enabled</p>
</div>

<!-- Installed from Marketplace -->
<div class="rounded-lg bg-yellow-50 p-4">
	<h3>Installed</h3>
	<p class="text-2xl font-bold">{installedWidgets.length}</p>
	<p class="text-sm">From marketplace</p>
</div>
```

#### Widget Status Indicators

- **🔵 CORE** - Core widget (cannot disable)
- **🟢 ACTIVE** - Custom widget (enabled)
- **🟡 INSTALLED** - Widget installed but inactive
- **⚪ INACTIVE** - Widget disabled or not installed

## 🔧 API Endpoints

### Widget Management APIs

#### Get Installed Widgets

```typescript
GET /api/widgets/installed?tenantId={tenantId}

Response:
{
  "widgets": ["colorPicker", "currency", "rating"],
  "total": 3,
  "tenantId": "tenant-123"
}
```

#### Install Widget

```typescript
POST /api/widgets/install
{
  "widgetId": "premium-gallery",
  "tenantId": "tenant-123"
}

Response:
{
  "success": true,
  "widgetId": "premium-gallery",
  "installedAt": "2025-08-05T10:00:00Z",
  "message": "Widget installed successfully"
}
```

#### Uninstall Widget

```typescript
POST /api/widgets/uninstall
{
  "widgetName": "premiumGallery",
  "tenantId": "tenant-123"
}

Response:
{
  "success": true,
  "widgetName": "premiumGallery",
  "uninstalledAt": "2025-08-05T10:00:00Z",
  "message": "Widget uninstalled successfully"
}
```

### Marketplace APIs

#### Browse Marketplace

```typescript
GET /api/marketplace/widgets?category=media&search=gallery&sort=downloads

Response:
{
  "widgets": [
    {
      "id": "premium-gallery",
      "name": "Premium Gallery",
      "description": "Advanced image gallery with lightbox...",
      "version": "2.1.0",
      "author": "WidgetCorp",
      "icon": "mdi:view-gallery",
      "price": "$29.99",
      "category": "Media",
      "rating": 4.8,
      "downloads": 1250,
      "dependencies": ["mediaUpload"],
      "compatibility": ">=1.0.0"
    }
  ],
  "total": 12,
  "filters": { "category": "media", "search": "gallery" }
}
```

## 📦 Widget Installation Process

### 1. Discovery Phase

```typescript
// User browses marketplace
await loadMarketplaceWidgets();

// Filter and search
const widgets = await fetch('/api/marketplace/widgets?category=forms');
```

### 2. Installation Phase

```typescript
// Download and install widget
const result = await fetch('/api/widgets/install', {
	method: 'POST',
	body: JSON.stringify({ widgetId: 'advanced-form', tenantId })
});

// Widget files are downloaded to tenant directory
// Database is updated with installation record
// Widget is registered in the system
```

### 3. Activation Phase

```typescript
// User activates installed widget
await widgetStoreActions.updateWidgetStatus('advancedForm', 'active', tenantId);

// Widget becomes available in collection builder
// Dependencies are validated
// Collections are updated if needed
```

## 🏗️ Multi-Tenant Architecture

### Tenant Isolation

```
📁 widgets/
├── core/                       # Global core widgets
│   ├── input/
│   ├── checkbox/
│   └── mediaUpload/
│
├── marketplace/                # Downloaded marketplace widgets
│   ├── premium-gallery/
│   ├── advanced-calendar/
│   └── social-embed/
│
└── tenants/                   # Tenant-specific installations
    ├── tenant-123/
    │   ├── installed.json      # List of installed widgets
    │   ├── active.json        # List of active widgets
    │   └── widgets/           # Tenant widget files
    │       ├── premium-gallery/
    │       └── custom-form/
    │
    └── tenant-456/
        ├── installed.json
        ├── active.json
        └── widgets/
```

### Database Schema

```typescript
// Widget Installation Record
interface WidgetInstallation {
	id: string;
	tenantId: string;
	widgetId: string; // Marketplace widget ID
	widgetName: string; // Local widget name
	version: string;
	installedAt: Date;
	installedBy: string; // User ID
	isActive: boolean;
	configuration: object; // Widget-specific config
	dependencies: string[]; // Required widgets
}

// Marketplace Widget
interface MarketplaceWidget {
	id: string;
	name: string;
	description: string;
	version: string;
	author: string;
	category: string;
	price: number | 'free';
	rating: number;
	downloads: number;
	dependencies: string[];
	compatibility: string; // Version requirement
	packageUrl: string; // Download URL
	documentation: string; // Docs URL
	screenshots: string[];
}
```

## 🔐 Security & Permissions

### Permission System

```typescript
// Widget management permissions
const permissions = {
	'config:widgetManagement': 'View widget management page',
	'config:widgetInstall': 'Install widgets from marketplace',
	'config:widgetUninstall': 'Uninstall widgets',
	'config:widgetActivate': 'Activate/deactivate widgets',
	'config:marketplace': 'Access marketplace features'
};
```

### Widget Validation

```typescript
// Validate widget before installation
interface WidgetValidation {
	isValid: boolean;
	errors: string[];
	warnings: string[];
	securityChecks: {
		codeSignature: boolean;
		permissions: boolean;
		dependencies: boolean;
		compatibility: boolean;
	};
}
```

## 🧪 Testing Widget Management

### Unit Tests

```typescript
// Test widget installation
describe('Widget Installation', () => {
	test('should install widget successfully', async () => {
		const result = await installWidget('premium-gallery', 'tenant-123');
		expect(result.success).toBe(true);
		expect(result.widgetId).toBe('premium-gallery');
	});

	test('should validate dependencies', async () => {
		const validation = await validateWidgetDependencies('advanced-form');
		expect(validation.missingDependencies).toEqual([]);
	});
});
```

### Integration Tests

```typescript
// Test marketplace workflow
test('complete marketplace workflow', async ({ page }) => {
	await page.goto('/config/widgetManagement');

	// Browse marketplace
	await page.click('[data-testid="marketplace-tab"]');
	await expect(page.locator('[data-testid="widget-card"]')).toBeVisible();

	// Install widget
	await page.click('[data-testid="install-widget-btn"]');
	await expect(page.locator('.success-message')).toBeVisible();

	// Activate widget
	await page.click('[data-testid="installed-tab"]');
	await page.click('[data-testid="activate-widget-btn"]');
	await expect(page.locator('.widget-active')).toBeVisible();
});
```

## 🚀 Future Enhancements

### Planned Features

- **📱 Widget Store App** - Dedicated marketplace application
- **🔄 Auto-Updates** - Automatic widget version updates
- **💳 Payment Integration** - Stripe/PayPal for paid widgets
- **📊 Analytics** - Widget usage and performance metrics
- **🎨 Widget Themes** - Customizable widget appearances
- **🔌 Plugin System** - Extended widget functionality
- **🌐 CDN Integration** - Faster widget downloads
- **📝 Reviews & Ratings** - Community feedback system

### Development Roadmap

1. **Phase 1**: Basic marketplace functionality ✅
2. **Phase 2**: Payment processing and premium widgets
3. **Phase 3**: Auto-updates and version management
4. **Phase 4**: Advanced analytics and reporting
5. **Phase 5**: Community features and widget sharing

## 💡 Best Practices

### For Widget Management

- **🔍 Regular Audits** - Review installed widgets periodically
- **📋 Dependency Tracking** - Monitor widget dependencies
- **🔐 Security Updates** - Keep widgets updated for security
- **📊 Usage Analysis** - Track which widgets are actually used
- **🧪 Testing Environment** - Test widgets before production

### For Marketplace Integration

- **🔒 Security First** - Validate all marketplace widgets
- **📚 Documentation** - Maintain clear installation guides
- **🎯 User Experience** - Make installation process simple
- **🔄 Rollback Plans** - Enable easy widget removal
- **📈 Performance Monitoring** - Track marketplace performance

---

The Widget Marketplace system provides a scalable, secure way to extend SveltyCMS functionality while maintaining multi-tenant isolation and proper security controls. This architecture supports both free and premium widgets with a complete installation and management workflow.
